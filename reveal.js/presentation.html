<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Refactoring For Machine Dignity</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Refactoring For Machine Dignity</h1>
				</section>
				<section>
					<h1>Me</h1>
          <ul>
            <li class='fragment'>You're probably here to see Evan Phoenix</li>
            <li class='fragment'>Rubinius Author, Conference Organizer</li>
            <li class='fragment'>That's not me</li>
            <li class='fragment'>I'm Evan Burchard</li>
            <li class='fragment'>I like to write things</li>
          </ul>
				</section>
				<section>
					<h3>The book I wanted when I started programming</h3>
          <img src="web_game.jpg" alt="" />
				</section>
				<section>
					<h3>The book I wanted when I wrote the first book</h3>
          <img src="refactoring_js.jpg" alt="" />
				</section>
				<section>
					<h1>Keeping Ruby Weird</h1>
				</section>
				<section>
					<h1>Overview: What</h1>
          <ul>
            <li class='fragment'>Refactoring, Safety, and Quality</li>
            <li class='fragment'>Prescriptive Approaches to Quality</li>
            <li class='fragment'>Quality Engines</li>
            <li class='fragment'>Machine Dignity</li>
          </ul>
				</section>
				<section>
					<h1>Overview: How</h1>
          <ul>
            <li class='fragment'>A bit of talking</li>
            <li class='fragment'>Working with code</li>
          </ul>
				</section>
				<section>
          <section>
            <h1>Refactoring</h1>
            <h3>Definition</h3>
					<p class='fragment'>Ensuring consistent behavior while changing code.</p>
          </section>
          <section>
            <h1>Refactoring</h1>
            <h3 class='fragment'>William Opdyke's Thesis (1995)</h3>
            <p class='fragment'> "Two design constraints needed in refactoring are class invariants and exclusive components." </p>
          </section>
          <section>
            <p>"In general, it is undecidable whether a predicate is a class invariant or whether a member variable is a component. Since refactorings must be behavior preserving, it is better to mistakenly decide that a predicate is not a class invariant (and so not be able to perform a legal refactoring) than it is to mistakenly decide that a predicate is a class invariant and eventually perform an illegal refactoring."
            </p>
          </section>
          <section>
            <p>"Thus, a system for supporting refactorings will use conservative algorithms for deciding whether a predicate is a class invariant or a member variable is a component. The thesis will describe some conservative algorithms for both problems that are based on data-flow analysis."
            </p>
          </section>
          <section>
            <img src="drake_reject.jpg" alt="" />
          </section>
          <section>
            <p>"Imagine that a circle is drawn around the parts of a program affected by a refactoring. The behavior as viewed from outside the circle does not change. For some refactorings, the circle surrounds most or all of the program... For other refactorings, the circle covers a much smaller area..."</p>
          </section>
          <section>
            <img src="drake_accept.jpg" alt="" />
          </section>
          <section>
            <h1>Refactoring</h1>
            <h3>What's Changed Since Then</h3>
            <ul>
						<li class="fragment">our languages</li>
						<li class="fragment">our tools</li>
						<li class="fragment">our notion of "safety"</li>
            </ul>
          </section>
          <section>
            <h1>Languages</h1>
            <ul>
              <li class="fragment">Dynamic</li>
              <li class="fragment">Multi-paradigmic (Not Always OOP)</li>
            </ul>
          </section>
          <section>
            <h1>Tools</h1>
            <ul>
              <li class="fragment">Testing &amp; Methodologies</li>
              <li class="fragment">Continuous Integration</li>
              <li class="fragment">Continuous Delivery</li>
              <li class="fragment">Distributed Version Control</li>
            </ul>
          </section>
          <section>
            <h1>Safety</h1>
            <h3 class='fragment'>Given the technology and process developments...</h3>
            <p class='fragment'>in general, we're making changes more quickly, and as Rails developers, tend to make changes based on "Confidence" rather than "Constraints."</p>
          </section>
          <section>
            <h1>Ensuring consistent behavior while changing code.</h1>
          </section>
          <section>
            <h3>Establishing tools and processes that monitor and create proxies for our confidence to support consistent behavior while changing code.</h3>
          </section>
          <section>
            <h1>A few proxies for confidence:</h1>
            <ul>
              <li class='fragment'>Code Reviews</li>
              <li class='fragment'>Fast and Frequently Run Tests</li>
              <li class='fragment'>Multi-level Testing</li>
              <li class='fragment'>Atomic Commits</li>
              <li class='fragment'>Test Coverage</li>
              <li class='fragment'>Other Code Metrics</li>
              <li class='fragment'>Style Guides &amp; Linters</li>
            </ul>
          </section>
				</section>
        <section>
          <h1>Quality</h1>
          <p class='fragment'>(aka, the <em>other</em> reason we change code)</p>
        </section>
				<section>
          <section>
            <h1>Prescriptive Quality</h1>
          </section>
          <section>
            <h1>A few ideas</h1>
            <ul>
              <li class='fragment'>DRY</li>
              <li class='fragment'>SOLID</li>
              <li class='fragment'>Follows Patterns {A, B, C...}</li>
              <li class='fragment'>Avoids Antipatterns {A, B, C...}</li>
              <li class='fragment'>Clean Code</li>
            </ul>
          </section>
          <section>
            <h1>Let's make our own principles of quality</h1>
            <p class='fragment'>I did this exercise with my dog. He used his name.</p>
          </section>
          <section>
            <img src="pip.jpg" alt="dog picture" />
          </section>
          <section>
            <h1>"PIP" Software Dev Principles</h1>
            <ul>
              <li>Push code every day</li>
              <li>Interrogative (?) and Destructive (!) method suffixes</li>
              <li>Pupper-oriented design</li>
            </ul>
          </section>
          <section>
            <h1>Let's make our own principles of quality</h1>
            <p class='fragment'>You can use your name or just a word you like if your name is long/a secret.</p>
            <p class='fragment'>Let's take 3 minutes.</p>
          </section>
          <section>
            <h1>What did we come up with?</h1>
            <h3 class='fragment'>Anyone have trouble with particular letters?</h3>
          </section>
          <section>
            <h1>We'll do that again at the end.</h1>
          </section>
				</section>
        <section>
          <section>
            <h1>Some "Engines" For Quality</h1>
            <ul>
              <li class='fragment'>Livable</li>
              <li class='fragment'>Maintainable</li>
              <li class='fragment'>Not Smelly (has transcended prescriptive)</li>
              <li class='fragment'>Considered Harmful</li>
              <li class='fragment'>Rails Doctrine</li>
              <li class='fragment'>Follows Patterns</li>
            </ul>
          </section>
          <section>
            <h3>These come with more general motivating questions. Also...</h3>
            <ul>
              <li class='fragment'>Less brittle</li>
              <li class='fragment'>Less context dependent</li>
              <li class='fragment'>Less immediately applicable</li>
              <li class='fragment'>Both engines and prescriptive principles are useful</li>
            </ul>
          </section>
        </section>
				<section>
          <section>
            <h1>Refactoring For Machine Dignity</h1>
            <h3>(Our Engine)</h3>
          </section>
          <section>
            <h1>refactoring</h1>
            <p class='fragment'>"Establishing tools and processes that monitor and create proxies for our confidence to support consistent behavior while changing code."</p>
            <p class='fragment'>-Me</p>
          </section>
          <section>
            <h1>machine</h1>
            <p class='fragment'>"An object that runs a program."</p>
            <p class='fragment'>-Eric Steinhart</p>
          </section>
          <section>
            <h1>Dignity</h1>
            <p class='fragment'>"The idea that a being has an innate right to be valued, respected, and to receive ethical treatment."</p>
            <p class='fragment'>-Wikipedius</p>
          </section>
          <section>
            <h1>Dignity for <em>Machines</em> Instead of <em>Humans</em>?</h1>
          </section>
          <section>
            <h1>No</h1>
            <p class='fragment'>That's just a convenient place to begin our interogation.</p>
            <p class='fragment'>Also, it's where most of us spend a lot of our energy.</p>
          </section>
          <section>
            <h3>Two questions when thinking about the dignity of the machine:</h3>
            <ol>
              <li class='fragment'>Would you want to act as the machine?</li>
              <li class='fragment'>To what degree is the machine able to flourish?</li>
            </ol>
          </section>
          <section>
            <h3>We need context for these</h3>
          </section>
				</section>
        <section>
          <section>
            <h1>Our Lenses</h1>
            <h3>How can this code...</h3>
            <ol>
              <li class='fragment'>... be more useful to me? (Personal)</li>
              <li class='fragment'>... be more useful to others? (Shared)</li>
              <li class='fragment'>... impress or inspire someone? (Aesthetic)</li>
              <li class='fragment'>... express a considerate worldview? (Civil)</li>
            </ol>
          </section>
          <section>
            <h1>Our Lenses</h1>
            <p class='fragment'>In some ways, these are an extension of the old adage of "make it work, make it readable, make it fast," but in each of these contexts, the questions to motivate changes in our code can remain the same:</p>
            <ol>
              <li class='fragment'>Would you want to act as the machine?</li>
              <li class='fragment'>To what degree is the machine able to flourish?</li>
            </ol>
            <p class='fragment'>Which themselves come from the question: How can we grant our machines dignity in their work?</p>
          </section>
          <section>
            <h1>Circles and Preconditions</h1>
          </section>
          <section>
            <table>
              <tr>
                <th></th><th>Act As Machine</th><th>Flourishing</th>
              </tr>
              <tr>
                <td style='border-right:1px solid white'>Personal</td><td style='border-right:1px solid white'></td><td></td>
              </tr>
              <tr>
                <td style='border-right:1px solid white'>Shared</td><td style='border-right:1px solid white'></td><td></td>
              </tr>
              <tr>
                <td style='border-right:1px solid white'>Aesthetic</td><td style='border-right:1px solid white'></td><td></td>
              </tr>
              <tr>
                <td style='border-right:1px solid white'>Civil</td><td style='border-right:1px solid white'></td><td></td>
              </tr>
            </table>
          </section>
        </section>
        <section>
          <section>
            <h1>Let's use them</h1>
            <h3 class='fragment'>First, in addition to our lenses, we need a test framework</h3>
          </section>
          <section>
            <pre><code>
  def assert(code_as_string)
    raise 'NOOOOOOO' unless eval(code_as_string)
  end

</code></pre>
          </section>
          <section>
            <h1>Lens 1: Personal</h1>

<pre><code>
  def s(a,b);a+b;end;puts s(2,3)
  assert('s(2, 3) == 5')

</code></pre>
          </section>
          <section>
            <h1>Lens 2: Shared</h1>
            <p class='fragment'>Who are you working with?</p>
          </section>
          <section>
            <h1>Lens 2: Shared</h1>
<pre><code>puts 3
puts 3
puts 8
puts 3
puts 3
puts 3
puts 3
puts 3
puts 2
puts 3
puts 1
puts 3
puts 3
</code></pre>
          </section>
          <section>
            <h1>Lens 2: Shared</h1>
<pre><code>
def remove_prefix(string)
  if(string[0..6] == 'prefix')
    return string[7..-1]
  else
    return string
  end
end
</code></pre>
          </section>
          <section>
            <h1>Lens 3: Aesthetic</h1>
            <p class='fragment'>Who are you trying to impress?</p>
            <ul>
              <li class='fragment'>Interview?</li>
              <li class='fragment'>Code Review?</li>
              <li class='fragment'>Stack Overflow Participants?</li>
              <li class='fragment'>Blog Audience?</li>
              <li class='fragment'>Obfuscated C Judges?</li>
              <li class='fragment'>JS XK Judges?</li>
              <li class='fragment'>"Easier to reason about"? (Be careful here)</li>
            </ul>
          </section>
          <section>
            <h1>Lens 3: ! Golf</h1>
<pre><code>def factorial(number)
  if(number > 1)
    factorial(number - 1) * number
  else
    1
  end
end
</code></pre>

          </section>
          <section>
            <h1>Lens 4: Civil</h1>
<pre><code>def blow_up_the_moon
  # We probably shouldn't blow up the moon...
  raise 'moon will blow up when you run this,
  comment this line to run'
  # comment out the line above this one to
  # run the code below
  # keep in mind that this will blow up the moon
  # and the moon provides the Earth with protection
  # against asteroids

  code_that_actually_blows_up_the_moon
end
</code></pre>
          </section>
        </section>
        <section>
          <section>
            <h1>Quality at all levels</h1>
          </section>
          <section>
            <h3>Contexts for Lens Conflicts and interplay</h3>
            <ul>
              <li class='fragment'>Writing code</li>
              <li class='fragment'>Code Reviews</li>
              <li class='fragment'>Interviews</li>
              <li class='fragment'>Competition</li>
              <li class='fragment'>Open Source</li>
              <li class='fragment'>All the lenses are moving targets</li>
            </ul>
          </section>
          <section>
            <h1>Quality doesn't stop at Personal code</h1>
            <ul>
              <li class='fragment'>Adapt Your Code for Others</li>
              <li class='fragment'>Learn About Various Aesthetics</li>
              <li class='fragment'>Decide on things you won't do</li>
            </ul>
          </section>
          <section>
            <h3>You control what Civil code is operationalized</h3>
              <p class='fragment'>We operationalize the company's worldview, but in arguing for higher quality, we often stop at the aesthetic.</p>
              <p class='fragment'>Often, their worldview is simply "we should be growing" with some other stuff tacked on.</p>
              <p class='fragment'>As DHH said, this can be uninspiring.</p>
              <p class='fragment'>Destructive is worse than uninspiring, and is common.</p>
          </section>
          <section>
            <h3>The Agile Manifesto cedes control of the civil aspects</h3>
            <p class='fragment'>It argues well for a quality process, but kicks off as:</p>
            <p class='fragment'>"Our highest priority is to satisfy the customer through early and continuous delivery of valuable software."</p>
            <p class='fragment'>This assumed primacy of the customer downplays the our role.</p>
          </section>
          <section>
            <h3>You have other options</h3>
            <ul>
              <li class='fragment'>Adopt the "Ethical Design Manifesto," "Inclusive Design," "GNU Manifesto" or make up your own guiding principles</li>
              <li class='fragment'>Avoid (or quit) implementations, projects, teams, and companies that don't support your values.</li>
              <li class='fragment'>Support team members who are wronged.</li>
              <li class='fragment'>Offer a sliding scale for clients who support your values.</li>
              <li class='fragment'>Support and argue for your company supporting open source devlopers (with money).</li>
              <li class='fragment'>Understand where the money comes from and goes.</li>
            </ul>
          </section>
          <section>
            <h3>This is becoming more important</h3>
            <p class='fragment'>Machine Learning makes our role very obvious because it gives so much autonomy.</p>
            <p class='fragment'>Web apps have the same capacity.</p>
            <aside class='notes'>
              Social minus sying
            </aside>
          </section>
          <section>
            <h1>Regardless of the conflicts</h1>
              <h3 class='fragment'>Please don't Blow up the moon</h3>
          </section>
          <section>
            <h1>But really</h1>
              <p class='fragment'>Consider using quality, and possibly machine dignity, as motivations for doing good work.</p>
          </section>
        </section>
				<section>
					<h1>Techniques to be comfortable with</h1>
          <ul>
            <li class='fragment'>Naming and renaming things</li>
            <li class='fragment'>Extracting</li>
            <li class='fragment'>Inlining</li>
            <li class='fragment'>Declarative over Imperative</li>
          </ul>
				</section>
				<section>
					<h1>Some Ruby Design Considerations</h1>
          <ul>
            <li class='fragment'>DSLs</li>
            <li class='fragment'>Passing nil</li>
            <li class='fragment'>Variables out of nowhere</li>
            <li class='fragment'>Deep Inheritance</li>
            <li class='fragment'>Impractical Grep via Metaprogramming</li>
          </ul>
          <p class='fragment'>But metaprogramming for reflection is great</p>
				</section>
        <section>
          <section>
            <h1>Let's revise our principles of quality</h1>
          </section>
          <section>
            <h1>Keep a few things in mind</h1>
          </section>
          <section>
            <ul>
              <li class='fragment'>Prescription vs. Engine</li>
              <li class='fragment'>Personal Lens</li>
              <li class='fragment'>Shared Lens</li>
              <li class='fragment'>Aesthetic Lens</li>
              <li class='fragment'>Civil Lens</li>
              <li class='fragment'>Would you want to perform as the machine?</li>
              <li class='fragment'>How can you promote flourishing?</li>
            </ul>
            <p class='fragment'>Take 2 minutes</p>
          </section>
          <section>
            <h1>Any different?</h1>
          </section>
        </section>
				<section>
					<h1>Thanks!</h1>
          <h3 class='fragment'>And again, please don't Blow up the moon</h3>
				</section>
				<section>
          <h1>Resources</h1>
          <ul>
            <li>github.com/evanburchard/machine_dignity_workshop</li>
            <li>wikipedia.org/wiki/Dignity</li>
            <li>"Flourishing": wikipedia.org/wiki/Eudaimonia</li>
            <li>wikipedia.org/wiki/Problem_of_other_minds</li>
            <li>"Moral Machines" by Wendell Wallach and Colin Allen</li>
            <li>Search: "William Opdyke" Thesis PDF</li>
            <li>refactoringjs.com</li>
            <li>The consequences of an insightful algorithm</li>
          </ul>
				</section>
				<section>
          <h1>Bonus: Characterization Tests</h1>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
